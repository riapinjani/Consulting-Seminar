---
title: "Project Draft"
author: "Ria Pinjani"
date: "10/19/2019"
output: html_document
---

```{r ,include=FALSE}
setwd('/Users/riapinjani/Documents/Fall\'19/Statistical\ Consulting')


```

```{r}

library('readxl')
require('plyr')
require('sas7bdat')
require('tidyr')
require('sf')
require(mapview)

```

```{r}
foil_2016 <- read_excel('FOIL\ Case\ No.\ 375-2016.xlsx')
foil_2007_2015  <- read_excel('FOIL Case No. 83-2017_List of Cigarette Retail Dealers from 2007 to 2015.xlsx')
```

Combining the Data
```{r}
colnames(foil_2016) <- c("LICENSE_NBR", "STATUS", "EXPIRATION_DATE", "INDUSTRY"   ,"BUSINESS_NAME", "BUILDING",  "STREET" ,"CITY","STATE" , "ZIP" , "BORO" )

foil_2007_2016 <-  join(foil_2016, foil_2007_2015, type = 'full')

foil_2007_2016 <- unite(foil_2007_2016,"address", c(BUILDING, STREET, CITY, STATE, ZIP), sep = " ")
```

```{r}
# survey_2016 <- read.sas7bdat('chs2016_public.sas7bdat')
```

```{r}

foil_2007_2016_subset <- foil_2007_2016[1:50,]

urladdresses <- do.call(rbind, lapply(foil_2007_2016_subset$address, URLencode))
```

```{r}
search_urls <- paste("https://geosearch.planninglabs.nyc/v1/search?text=", urladdresses, sep="")
geocoded_results <- do.call(rbind, lapply(search_urls, sf::st_read))
```




```{r}
mapview::mapview(geocoded_results)
```






